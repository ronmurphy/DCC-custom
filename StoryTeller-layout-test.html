<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StoryTeller Layout Test - Low Resolution</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f0f0f0;
        }
        
        .test-container {
            background: white;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .simulator {
            border: 3px solid #007bff;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            background: white;
        }
        
        .device-info {
            background: #007bff;
            color: white;
            padding: 8px 12px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .chat-test {
            height: 600px; /* Amazon Fire 7" height simulation */
            display: flex;
            flex-direction: column;
            background: #f8f9fa;
        }
        
        .header-sim {
            background: #343a40;
            color: white;
            padding: 12px;
            font-size: 0.9em;
            flex-shrink: 0;
        }
        
        .chat-messages-sim {
            background: #fff;
            border: 1px solid #dee2e6;
            flex: 1;
            overflow-y: auto;
            padding: 8px;
            margin: 8px;
            border-radius: 4px;
        }
        
        .chat-toolbar-sim {
            background: #e9ecef;
            padding: 6px 12px;
            border-top: 1px solid #dee2e6;
            font-size: 0.75em;
            flex-shrink: 0;
        }
        
        .player-chips-sim {
            background: rgba(30, 30, 45, 0.8);
            color: white;
            padding: 8px 12px;
            font-size: 0.8em;
            flex-shrink: 0;
        }
        
        .chat-input-sim {
            background: white;
            border-top: 1px solid #dee2e6;
            padding: 8px;
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }
        
        .input-sim {
            flex: 1;
            padding: 8px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
        }
        
        .send-sim {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .message {
            background: #f8f9fa;
            padding: 8px;
            margin-bottom: 4px;
            border-radius: 4px;
            border-left: 3px solid #007bff;
        }
        
        .test-info {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        
        .issue-sim {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 12px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üîß StoryTeller Chat Layout Test - Low Resolution Displays</h1>
    
    <div class="test-container">
        <div class="test-info">
            <strong>Issue:</strong> On low-resolution tablets (like Amazon Fire 7"), the chat input area was hidden beneath the panel because the chat messages were using too much height with rigid calculations.
        </div>
        
        <h3>Amazon Fire 7" Tablet Simulation (1024√ó600)</h3>
        <p><strong>Height available for chat:</strong> ~600px after browser chrome</p>
        
        <div class="simulator">
            <div class="device-info">Amazon Fire 7" - 600px Height Simulation</div>
            <div class="chat-test">
                <div class="header-sim">StoryTeller Header (~50px)</div>
                
                <div class="chat-messages-sim">
                    <div class="message">
                        <strong>System:</strong> Chat system ready.
                    </div>
                    <div class="message">
                        <strong>Player:</strong> Testing message display...
                    </div>
                    <div class="message">
                        <strong>DM:</strong> Roll for initiative!
                    </div>
                    <div class="message">
                        <strong>Player:</strong> I rolled a 15! üé≤
                    </div>
                    <div class="message">
                        <strong>System:</strong> Combat begins!
                    </div>
                    <p style="text-align: center; color: #666; font-style: italic;">
                        Messages area - now responsive to available height
                    </p>
                </div>
                
                <div class="chat-toolbar-sim">
                    üì∑ Image | üí¨ Picker | üóëÔ∏è Clear | üì• Export (~30px)
                </div>
                
                <div class="player-chips-sim">
                    üë§ You | üßô Wizard | ‚öîÔ∏è Fighter | üèπ Ranger (~40px)
                </div>
                
                <div class="chat-input-sim">
                    <input type="text" class="input-sim" placeholder="Type your message..." value="Input should be visible now!">
                    <button class="send-sim">Send</button>
                </div>
            </div>
        </div>
        
        <div class="test-info">
            <strong>‚úÖ Fixed with responsive height calculations:</strong>
            <ul>
                <li><code>@media (max-height: 800px)</code> - Reduces chat height to <code>calc(100vh - 240px)</code></li>
                <li><code>@media (max-height: 700px)</code> - Further reduces to <code>calc(100vh - 200px)</code></li>
                <li>Chat input area uses <code>position: sticky; bottom: 0;</code> to stay visible</li>
                <li>All elements have <code>flex-shrink: 0</code> to prevent compression</li>
            </ul>
        </div>
    </div>

    <div class="test-container">
        <h3>Before Fix (Would show this issue):</h3>
        <div class="issue-sim">
            ‚ùå <strong>Problem:</strong> Chat messages used <code>height: calc(100vh - 280px)</code><br>
            On 600px tall display: 600 - 280 = 320px for messages + ~100px for toolbars = input area pushed off-screen
        </div>
        
        <h3>After Fix:</h3>
        <div class="test-info">
            ‚úÖ <strong>Solution:</strong> Chat messages use <code>height: calc(100vh - 200px)</code> on small screens<br>
            On 600px tall display: 600 - 200 = 400px for messages + input area fits comfortably
        </div>
    </div>

    <script>
        // Simulate various screen heights
        function testHeight(height) {
            const simulator = document.querySelector('.chat-test');
            simulator.style.height = height + 'px';
            console.log(`Testing ${height}px height`);
        }
        
        // Log current window height for reference
        console.log('Current window height:', window.innerHeight);
        console.log('Current window width:', window.innerWidth);
        
        // Test different heights
        setTimeout(() => testHeight(700), 2000);
        setTimeout(() => testHeight(600), 4000);
        setTimeout(() => testHeight(800), 6000);
    </script>
</body>
</html>
